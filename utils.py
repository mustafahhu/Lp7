import json
import requests
import traceback

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ù† Ù…Ù„Ù config.json
def load_config(path="config.json"):
    try:
        with open(path, 'r') as f:
            return json.load(f)
    except Exception as e:
        print(f"âŒ ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª: {e}")
        return {}

# Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙˆØªØ§Øª
def send_telegram_message(text, bots):
    for bot in bots:
        try:
            requests.post(
                f"https://api.telegram.org/bot{bot['token']}/sendMessage",
                data={
                    "chat_id": bot['chat_id'],
                    "text": text,
                    "parse_mode": "Markdown"
                }
            )
        except Exception as e:
            print(f"âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ Ø¨ÙˆØª: {e}")

# Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¹Ù†Ø¯ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¨ÙˆØª
def notify_start(bots):
    send_telegram_message("âœ… ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª Ø¨Ù†Ø¬Ø§Ø­", bots)

# Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ø¹Ù†Ø¯ ØªÙˆÙ‚Ù Ø§Ù„Ø¨ÙˆØª Ø¨Ø³Ø¨Ø¨ Ø®Ø·Ø£
def notify_error(bots, err_msg=None):
    error_text = f"âŒ ØªÙˆÙ‚Ù Ø§Ù„Ø¨ÙˆØª Ø¨Ø³Ø¨Ø¨ Ø®Ø·Ø£:\n```{traceback.format_exc()}```"
    if err_msg:
        error_text += f"\nğŸ“Œ {err_msg}"
    send_telegram_message(error_text, bots)
